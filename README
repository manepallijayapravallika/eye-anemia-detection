# Eye Anemia Detection using Explainable AI

## A Non-Invasive Eye Anemia Diagnosis System Using Multi-Branch CNN

Mini Project | B.Tech Computer Science & Engineering

---

## About the Project

Anemia is one of the most widespread yet frequently undiagnosed health conditions. Traditional diagnosis requires invasive blood testing and laboratory infrastructure.

This project presents a non-invasive, AI-powered system that detects anemia using eye images. The system analyzes conjunctival eye regions through deep learning and predicts whether a person is:

* Anemic
* Non-Anemic

The model also provides a confidence score and visual explanations to enhance transparency and interpretability.

---

## Project Objective

The objective of this project is to develop an end-to-end AI system that:

* Detects anemia using only eye images
* Eliminates the need for blood sample collection
* Provides interpretable AI explanations
* Deploys as a real-time web application

---

## System Workflow

1. User uploads an eye image through the web interface
2. Image preprocessing (resizing and normalization)
3. Feature extraction using a MobileNetV2-based CNN architecture
4. Binary classification (Anemic / Non-Anemic)
5. Grad-CAM++ heatmap generation
6. SHAP-based pixel contribution analysis
7. Result displayed with prediction and confidence score

---

## Model Details

* Input Size: 224 × 224 RGB
* Architecture: MobileNetV2-based Convolutional Neural Network
* Output: Binary classification
* Decision Threshold: 0.4
* Explainability Methods:

  * Grad-CAM++ (Region-level importance visualization)
  * SHAP (Pixel-level attribution analysis)

---

## Technologies Used

### Backend

* Python
* FastAPI
* TensorFlow / Keras
* OpenCV
* SHAP
* Uvicorn

### Frontend

* HTML
* CSS

### Development Tools

* Jupyter Notebook
* VS Code
* GitHub

---

## Project Structure

```
Eye-Anemia-Detection/
│
├── app1.py                    # FastAPI backend
├── fire_today.ipynb           # Model training notebook
│
├── model/
│   └── fire_today.keras       # Trained CNN model
│
├── utils/
│   ├── gradcam.py
│   └── shap_explainer.py
│
├── templates/
│   ├── index.html
│   ├── result1.html
│   └── error.html
│
├── static/
│   ├── uploads/
│   ├── gradcam/
│   └── shap/
│
└── README.md
```

---

## Installation and Setup

### 1. Clone the Repository

```bash
git clone https://github.com/manepallijayapravallika/Eye-Anemia-Detection.git
cd Eye-Anemia-Detection
```

### 2. Create Virtual Environment

```bash
python -m venv venv
venv\Scripts\activate
```

### 3. Install Dependencies

```bash
pip install fastapi uvicorn tensorflow pillow opencv-python shap jinja2
```

### 4. Run the Application

```bash
uvicorn app1:app --reload
```

Open in browser:

```
http://127.0.0.1:8000
```

---

## Output Includes

* Prediction label
* Confidence percentage
* Grad-CAM++ visualization
* SHAP explanation
* Medical disclaimer

---

## Explainable AI Integration

This system integrates Explainable AI techniques to ensure model transparency:

Grad-CAM++ highlights important eye regions influencing the prediction.

SHAP provides pixel-level contribution analysis to understand how different parts of the image affect the decision.

These methods improve trust and interpretability in AI-driven healthcare systems.

---

## Research Inspiration

This project is inspired by research on explainable AI and optimized CNN architectures for non-invasive eye anemia detection.

---

## Disclaimer

This system is developed for educational and screening purposes only.
It is not intended to replace professional medical diagnosis.

---

## Application Preview

### Home Page
![Home Page](assets/homepage.png)

### Prediction Result
![Result](assets/result.png)

## Author

Manepalli Jayapravallika
B.Tech – Computer Science and Engineering
Mini Project

---

## Future Improvements

* Mobile deployment
* Multi-class anemia severity prediction
* Larger dataset training
* Cloud-based hosting
* Clinical validation studies

---

## Recruiter Summary

This project demonstrates:

* End-to-end machine learning deployment
* Healthcare AI application
* Integration of Explainable AI techniques
* Backend API development using FastAPI
* Model deployment in a web application
* Clean system architecture and modular code design
